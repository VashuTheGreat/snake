// // import React from 'react'
// // import Link from 'next/link'
// // const page = () => {
// //   return (
// //     <section className="text-gray-600 body-font">
// //     <div className="container px-5 py-24 mx-auto">
// //       <div className="flex flex-wrap -m-4 justify-center">
// //         <div className="lg:w-1/5 md:w-1/2 p-4 w-full shadow-lg m-2">
// //           <a href='/pdetail/tshirt' className="block relative rounded overflow-hidden">
// //             <img alt="ecommerce" className="object-cover object-top max-h-[601px] w-full h-full block" src="https://m.media-amazon.com/images/I/713n+TxyfCL._SX569_.jpg" />
// //           </a>
// //           <div className="mt-4">
// //             <h3 className="text-gray-500 text-xs tracking-widest title-font mb-1">CATEGORY</h3>
// //             <h2 className="text-gray-900 title-font text-lg font-medium">The Catalyzer</h2>
// //             <p className="mt-1">₹16.00</p>
// //           </div>
// //         </div>
// //         <div className="lg:w-1/5 md:w-1/2 p-4 w-full shadow-lg m-2">
// //           <a href='/pdetail/tshirt' className="block relative rounded overflow-hidden">
// //             <img alt="ecommerce" className="object-cover object-top max-h-[601px] w-full h-full block" src="https://m.media-amazon.com/images/I/713n+TxyfCL._SX569_.jpg" />
// //           </a>
// //           <div className="mt-4">
// //             <h3 className="text-gray-500 text-xs tracking-widest title-font mb-1">CATEGORY</h3>
// //             <h2 className="text-gray-900 title-font text-lg font-medium">Shooting Stars</h2>
// //             <p className="mt-1">₹21.15</p>
// //           </div>
// //         </div>
// //         <div className="lg:w-1/5 md:w-1/2 p-4 w-full shadow-lg m-2">
// //           <a href='/pdetail/tshirt' className="block relative rounded overflow-hidden">
// //             <img alt="ecommerce" className="object-cover object-top max-h-[601px] w-full h-full block" src="https://m.media-amazon.com/images/I/713n+TxyfCL._SX569_.jpg" />
// //           </a>
// //           <div className="mt-4">
// //             <h3 className="text-gray-500 text-xs tracking-widest title-font mb-1">CATEGORY</h3>
// //             <h2 className="text-gray-900 title-font text-lg font-medium">Neptune</h2>
// //             <p className="mt-1">₹12.00</p>
// //           </div>
// //         </div>
// //         <div className="lg:w-1/5 md:w-1/2 p-4 w-full shadow-lg m-2">
// //           <a href='/pdetail/tshirt' className="block relative rounded overflow-hidden">
// //             <img alt="ecommerce" className="object-cover object-top max-h-[601px] w-full h-full block" src="https://m.media-amazon.com/images/I/713n+TxyfCL._SX569_.jpg" />
// //           </a>
// //           <div className="mt-4">
// //             <h3 className="text-gray-500 text-xs tracking-widest title-font mb-1">CATEGORY</h3>
// //             <h2 className="text-gray-900 title-font text-lg font-medium">The 400 Blows</h2>
// //             <p className="mt-1">₹18.40</p>
// //           </div>
// //         </div>
// //         <div className="lg:w-1/5 md:w-1/2 p-4 w-full shadow-lg m-2">
// //           <a href='/pdetail/tshirt' className="block relative rounded overflow-hidden">
// //             <img alt="ecommerce" className="object-cover object-top max-h-[601px] w-full h-full block" src="https://m.media-amazon.com/images/I/713n+TxyfCL._SX569_.jpg" />
// //           </a>
// //           <div className="mt-4">
// //             <h3 className="text-gray-500 text-xs tracking-widest title-font mb-1">CATEGORY</h3>
// //             <h2 className="text-gray-900 title-font text-lg font-medium">The Catalyzer</h2>
// //             <p className="mt-1">₹16.00</p>
// //           </div>
// //         </div>
// //         <div className="lg:w-1/5 md:w-1/2 p-4 w-full shadow-lg m-2">
// //           <a href='/pdetail/tshirt' className="block relative rounded overflow-hidden">
// //             <img alt="ecommerce" className="object-cover object-top max-h-[601px] w-full h-full block" src="https://m.media-amazon.com/images/I/713n+TxyfCL._SX569_.jpg" />
// //           </a>
// //           <div className="mt-4">
// //             <h3 className="text-gray-500 text-xs tracking-widest title-font mb-1">CATEGORY</h3>
// //             <h2 className="text-gray-900 title-font text-lg font-medium">Shooting Stars</h2>
// //             <p className="mt-1">₹21.15</p>
// //           </div>
// //         </div>
// //         <div className="lg:w-1/5 md:w-1/2 p-4 w-full shadow-lg m-2">
// //           <a href='/pdetail/tshirt' className="block relative rounded overflow-hidden">
// //             <img alt="ecommerce" className="object-cover object-top max-h-[601px] w-full h-full block" src="https://m.media-amazon.com/images/I/713n+TxyfCL._SX569_.jpg" />
// //           </a>
// //           <div className="mt-4">
// //             <h3 className="text-gray-500 text-xs tracking-widest title-font mb-1">CATEGORY</h3>
// //             <h2 className="text-gray-900 title-font text-lg font-medium">Neptune</h2>
// //             <p className="mt-1">₹12.00</p>
// //           </div>
// //         </div>
// //         <div className="lg:w-1/5 md:w-1/2 p-4 w-full shadow-lg m-2">
// //           <a href='/pdetail/tshirt'  className="block relative rounded overflow-hidden">
// //             <img alt="ecommerce" className="object-cover object-top max-h-[601px] w-full h-full block" src="https://m.media-amazon.com/images/I/713n+TxyfCL._SX569_.jpg" />
// //           </a>
// //           <div className="mt-4">
// //             <h3 className="text-gray-500 text-xs tracking-widest title-font mb-1">CATEGORY</h3>
// //             <h2 className="text-gray-900 title-font text-lg font-medium">The 400 Blows</h2>
// //             <p className="mt-1">₹18.40</p>
// //           </div>
// //         </div>
// //       </div>
// //     </div>
// //   </section>
  
// //   )
// // }

// // export default page
































// "use client"
// import React, { useEffect, useState } from 'react';
// import Link from 'next/link';
// import { useCart } from "@/context/CartContext";
// import { set } from 'mongoose';


// const Page = () => {
//     const [products, setProducts] = useState([]);
//   const { cart, addToCart, removeFromCart, clearCart, subTotal ,chimage} = useCart();
//   const [updatedImg, setUpdatedImg] = useState(null);
//   const [updatedSlug, setUpdatedSlug] = useState(null);
  
//   const handleClick = (img, slug) => {
   
//       chimage(img);
//       console.log("uibvgrouibedoduifiuvbuobuvu"+img)// Change image
//       setUpdatedImg(img); // Store updated image
//       setUpdatedSlug(slug); // Store slug for later use
//   };
  
//   useEffect(() => {
//       if (updatedImg && updatedSlug) {
//           setTimeout(() => {
//               window.open(`/pdetail/${updatedSlug}`, "_blank"); // Open link after image updates
//           }, 500); // Small delay to ensure image change
//       }
//   }, [updatedImg, updatedSlug]);    useEffect(() => {
//         const fetchProducts = async () => {
//             try {
//                 const res = await fetch('/api/getproduct'); // API route to fetch products
//                 const data = await res.json();
//                 setProducts(data.products);
//             } catch (error) {
//                 console.error('Error fetching products:', error);
//             }
//         };
//         fetchProducts();
//     }, []);

//     return (
//         <section className="text-gray-600 body-font">
//             <div className="container px-5 py-24 mx-auto">
//                 <div className="flex flex-wrap -m-4 justify-center">
//                     {products.map((product) => (
//                         <div key={product._id} className="lg:w-1/5 md:w-1/2 p-4 w-full shadow-lg m-2">
//                             <div className="block relative rounded overflow-hidden">
//                                                               <img
//                                 alt={product.title}
//                                 onClick={()=>{chimage(product.img)}}
//                                 className="object-cover object-top max-h-[601px] w-full block"
//                                 src={product.img}
// />
//                             </div>
//                             <div className="mt-4">
//                                 <h3 className="text-gray-500 text-xs tracking-widest title-font mb-1">{product.category}</h3>
//                                 <h2 className="text-gray-900 title-font text-lg font-medium">{product.title}</h2>
//                                 <p className="mt-1">₹{product.price}</p>
//                             </div>
//                         </div>
//                     ))}
//                 </div>
//             </div>
//         </section>
//     );
// };

// export default Page;


























































// "use client"
// import React, { useEffect, useState } from 'react';
// import { useRouter } from 'next/navigation';
// import { useCart } from "@/context/CartContext";

// const Page = () => {
//     const [products, setProducts] = useState([]);
//     const { chimage,sizesetter,setter,setTitlev,setPricev,setProductv } = useCart();
//     const router = useRouter();

//     useEffect(() => {
//         const fetchProducts = async () => {
//             try {
//                 const res = await fetch('/api/getproduct'); // API route to fetch products
//                 const data = await res.json();
//                 setProducts(data.products);
//             } catch (error) {
//                 console.error('Error fetching products:', error);
//             }
//         };
//         fetchProducts();
//     }, []);

//     const handleClick = (img, slug, size,color,title,price,p) => {
//         if (!img || !slug) return; // Ensure both are valid before proceeding
//         chimage(img);
//         sizesetter(size);
//         setter(color);
//         setTitlev(title);
//         setPricev(price);
//         setProductv(p);
//         console.log("setProductv"+p)
//         window.open(`/pdetail/${slug}`, "_blank");

//         // router.push(`/pdetail/${slug}`); // Redirect to product detail page
//     };

//     return (
//         <section className="text-gray-600 body-font">
//             <div className="container px-5 py-24 mx-auto">
//                 <div className="flex flex-wrap -m-4 justify-center">
//                     {products.map((product) => (
//                         <div key={product._id} className="lg:w-1/5 md:w-1/2 p-4 w-full shadow-lg m-2">
//                             <div 
//                                 className="block relative rounded overflow-hidden cursor-pointer"
//                                 onClick={() => handleClick(product.img, product.slug,product.size,product.color,product.title,product.price,product)}
//                             >
//                                 <img
//                                     alt={product.title}
//                                     className="object-cover object-top max-h-[601px] w-full block"
//                                     src={product.img}
//                                 />
//                             </div>
//                             <div className="mt-4">
//                                 <h3 className="text-gray-500 text-xs tracking-widest title-font mb-1">{product.category}</h3>
//                                 <h2 className="text-gray-900 title-font text-lg font-medium">{product.title}</h2>
//                                 <p className="mt-1">₹{product.price}</p>
//                             </div>
//                         </div>
//                     ))}
//                 </div>
//             </div>
//         </section>
//     );
// };

// export default Page;



















































"use client"
import React, { useEffect, useState } from 'react';
import { useRouter } from 'next/navigation';
import { useCart } from "@/context/CartContext";

const Page = () => {
    const [products, setProducts] = useState([]);
    const { chImage, setSize, setVariant, setTitlev, setPricev, setProductv } = useCart();
    const router = useRouter();

    useEffect(() => {
        const fetchProducts = async () => {
            try {
                const res = await fetch('/api/getproduct');
                const data = await res.json();
                console.log("Fetched Products:", data);
                if (data.products) {
                    setProducts(data.products);
                } else {
                    console.error("No products found in response", data);
                }
            } catch (error) {
                console.error('Error fetching products:', error);
            }
        };
        fetchProducts();
    }, []);

    const handleClick = (img, slug, size, color, title, price, p) => {
        if (!img || !slug) return;
        chImage(img);
        setSize(size);
        setVariant(color);
        setTitlev(title);
        setPricev(price);
        setProductv(p);
        console.log("Product Set:", p);
        window.open(`/pdetail/${slug}`, "_blank");
    };

    return (
        <section className="text-gray-600 body-font">
            <div className="container px-5 py-24 mx-auto">
                <div className="flex flex-wrap -m-4 justify-center">
                {products.length > 0 ? (
    products
        .filter(product => product.category === "Mugs") // Filtering by category
        .map((product) => (
            <div key={product._id} className="lg:w-1/5 md:w-1/2 p-4 w-full shadow-lg m-2">
                <div 
                    className="block relative rounded overflow-hidden cursor-pointer"
                    onClick={() => handleClick(product.img, product.slug, product.size, product.color, product.title, product.price, product)}
                >
                    <img
                        alt={product.title}
                        className="object-cover object-top max-h-[601px] w-full block"
                        src={product.img}
                    />
                </div>
                <div className="mt-4">
                    <h3 className="text-gray-500 text-xs tracking-widest title-font mb-1">{product.category}</h3>
                    <h2 className="text-gray-900 title-font text-lg font-medium">{product.title}</h2>
                    <p className="mt-1">₹{product.price}</p>
                </div>
            </div>
        ))
) : (
    <p className="text-center text-gray-500">No products available</p>
)}

                </div>
            </div>
        </section>
    );
};

export default Page;
